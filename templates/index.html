<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jobcus â€“ AI Career Advisor</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="/static/icons/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/static/style.css" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
      color: #111827;
      line-height: 1.6;
    }

    header {
      background-color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #e5e7eb;
    }

    .logo {
      font-weight: bold;
      font-size: 1.5rem;
    }

    .logo img {
      height: 40px;
    }
    
    .hero {
      padding: 60px 20px;
      text-align: center;
      background: linear-gradient(to right, #a855f7, #3b82f6);
      color: white;
    }

    .hero h1 {
      font-size: 2rem;
      margin-bottom: 20px;
    }

    .hero p {
      font-size: 1.2rem;
      margin-bottom: 30px;
    }

    .btn-primary {
      background-color: white;
      color: #3b82f6;
      padding: 12px 24px;
      border-radius: 9999px;
      font-weight: 600;
      text-decoration: none;
    }

    .section {
      padding: 40px 20px;
      text-align: center;
    }

    .section h2 {
      font-size: 1.75rem;
      margin-bottom: 16px;
    }

    .section p {
      max-width: 600px;
      margin: 0 auto 20px;
    }

    .features {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 30px;
    }

    .feature-box {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }

    footer {
      background-color: #111827;
      color: white;
      text-align: center;
      padding: 30px 20px;
    }

    @media(min-width: 768px) {
      .hero h1 {
        font-size: 3rem;
      }

      .features {
        flex-direction: row;
        justify-content: center;
      }

      .feature-box {
        width: 30%;
      }
    }
  </style>
</head>

  <header>
   
    <div class="logo">
    <div class="sidebar-toggle header-toggle" onclick="toggleSidebar()">
      <img src="/static/icons/hamburger.svg" alt="Toggle Sidebar">
    </div>
    <a href="/">
      <img src="/static/jobcus-logo.png" alt="Jobcus">
    </a>
  </div>
    
  <nav>
    <a href="#chatbox" style="margin-right: 20px; color: #111827; text-decoration: none;">Chat</a>
    <a href="#resume" style="color: #111827; text-decoration: none;">Resume</a>
  </nav>
</header>

  <section class="hero">
  <h1>Your AI Career Advisor</h1>
  <p style="font-size: 1.5rem; font-weight: 600; color: #cfe4ff; margin-bottom: 10px;">
    Achieve your career goals.<br>
    Effortlessly and confidently.
  </p>
  <p>We help you write your resume, find jobs, and prepare for interviews fast and smart.</p>
  <a href="#chatbox" class="btn-primary">Get Started</a>
</section>

  <section class="section" style="background-color: #f0f4ff;">
  <h2 style="color: #1e40af;">Find Jobs That Match Your Skills</h2>
  <p style="max-width: 600px; margin: auto;">
    You've got the talent, now let Jobcus guide your way. Get matched to roles that fit your skills and interests â€” powered by AI.
  </p>
  <a href="#chatbox" class="btn-primary" style="margin-top: 20px; display: inline-block;">Get Started Now</a>
</section>

  <section class="section">
    <h2>The new way to get hired</h2>
    <p>Jobcus uses AI to support your career journey intelligently, every step of the way.</p>
    <div class="features">
      <div class="feature-box">
        <h3>01 â€“ Personalized Job Matches</h3>
        <p>Get job listings based on your skills, experience, and interests â€” no guessing required.</p>
      </div>
      <div class="feature-box">
        <h3>02 â€“ Smart Resume Builder</h3>
        <p>Generate a professional resume in minutes, tailored to each job application.</p>
      </div>
      <div class="feature-box">
        <h3>03 â€“ Interview Preparation</h3>
        <p>Practice interview questions and get AI-driven tips to improve your confidence.</p>
      </div>
    </div>
  </section>

  <section style="text-align: center; padding: 40px 20px; background-color: #fef3c7;">
  <h3 style="margin-bottom: 10px;">Still not sure where to start?</h3>
  <a href="#chatbox" style="background-color: #111827; color: white; padding: 12px 24px; border-radius: 9999px; text-decoration: none;">
    Click here to give your CV a health check
  </a>
</section>

  <main class="centered" id="mainContainer">
    <div class="chatbox" id="chatbox"></div>
    <div id="job-results" class="job-results"></div>
    <form id="chat-form">
      <div class="center-wrapper" id="center-wrapper">
        <div class="prompt" id="prompt">
          <h1>What can I assist you with today?</h1>
        </div>
        <div class="input-container" id="inputContainer">
          <input type="text" id="userInput" placeholder="Ask your career question..." />
          <div class="icon-group">
            <label for="file-upload"><img src="/static/icons/paperclip.svg" alt="Attach"></label>
            <input id="file-upload" type="file" style="display: none;">
            <img src="/static/icons/mic.svg" alt="Mic" id="mic-button">
            <button type="submit"><img src="/static/icons/enter.svg" alt="Send"></button>
          </div>
        </div>
      </div>
    </form>

    <div class="search-suggestions">
      <div class="suggestion" onclick="insertSuggestion('How do I write a good CV?')">How do I write a good CV?</div>
      <div class="suggestion" onclick="insertSuggestion('What are trending tech jobs?')">What are trending tech jobs?</div>
      <div class="suggestion" onclick="insertSuggestion('How can I get into cybersecurity?')">How can I get into cybersecurity?</div>
    </div>
    <img src="/static/icons/pencilchat.svg" class="start-new-chat-icon" alt="New Chat" title="Start a new chat" onclick="clearChat()">

  <footer style="background-color: #111827; color: white; padding: 40px 20px; text-align: center;">
  <div style="margin-bottom: 20px;">
    <strong>Product</strong><br>
    <a href="#features" style="color: #ccc;">Features</a> | 
    <a href="#faq" style="color: #ccc;">FAQ</a> | 
    <a href="#chatbox" style="color: #ccc;">Join Now</a>
  </div>
  <div style="margin-bottom: 20px;">
    <strong>Social Media</strong><br>
    <a href="https://instagram.com" style="color: #ccc;">Instagram</a> | 
    <a href="https://linkedin.com" style="color: #ccc;">LinkedIn</a>
  </div>
  <div>
    <strong>Company</strong><br>
    <a href="#about" style="color: #ccc;">About Us</a> | 
    <a href="#faq" style="color: #ccc;">FAQ</a>
  </div>
  <p>Â© Copyright 2025. | Jobcus is an AI career advisor.</p>
</footer>

     </main>
   <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    function insertSuggestion(text) {
      document.getElementById("userInput").value = text;
      document.getElementById("userInput").focus();
    }

    const hamburger = document.getElementById("hamburger");
    const mobileMenu = document.getElementById("mobileMenu");
    const menuOverlay = document.getElementById("menuOverlay");

    hamburger.addEventListener("click", () => {
      mobileMenu.classList.toggle("active");
      menuOverlay.classList.toggle("active");
    });

    menuOverlay.addEventListener("click", () => {
      mobileMenu.classList.remove("active");
      menuOverlay.classList.remove("active");
    });

    function sharePage() {
      navigator.clipboard.writeText(window.location.href);
      alert("Link copied!");
    }

    const form = document.getElementById("chat-form");
    const input = document.getElementById("userInput");
    const chatbox = document.getElementById("chatbox");
    const prompt = document.getElementById("prompt");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const message = input.value.trim();
      if (!message) return;

      const res = await fetch("/ask", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message }),
      });

      input.value = "";

      const data = await res.json();
      prompt.style.display = 'none';
      document.querySelector("main").classList.add("chat-started");

      const aiBlock = document.createElement("div");
      aiBlock.className = "chat-entry";
      const existingEntries = document.querySelectorAll(".chat-entry").length;
      aiBlock.innerHTML = `
        <div class='user-question'><h2>${message}</h2></div>
        <div class='ai-answer'>
          <img src='/static/icons/copy.svg' alt='Copy' class='copy-icon'>
          <span class="typed-response"></span>
        </div>
        ${existingEntries > 0 ? "<hr>" : ""}
      `;
      chatbox.prepend(aiBlock);

      const typedSpan = aiBlock.querySelector(".typed-response");
      const replyText = marked.parse(data.reply);
      let i = 0;
      const typingSpeed = 2;

      (async () => {
        for (let i = 0; i <= replyText.length; i++) {
          typedSpan.innerHTML = replyText.slice(0, i);
          await new Promise(res => setTimeout(res, typingSpeed));
        }
          aiBlock.querySelector(".copy-icon").onclick = () => navigator.clipboard.writeText(data.reply);
          const existingHistory = localStorage.getItem("chatHistory") || "";
          const updatedHistory = aiBlock.outerHTML + existingHistory;
          localStorage.setItem("chatHistory", updatedHistory);
          maybeShowScrollIcon(); // ðŸ‘ˆ Add this here
          
      // âœ… Only fetch jobs if the message likely relates to job search
      if (data.suggestJobs) {
        await fetchJobs(message);
      }
        })();
      });

      window.addEventListener("DOMContentLoaded", () => {
      const saved = localStorage.getItem("chatHistory");
      if (saved) {
        chatbox.innerHTML = saved;
        prompt.style.display = 'none';
        document.querySelector("main").classList.add("chat-started");
      }
        maybeShowScrollIcon();
    });

    document.getElementById("mic-button").addEventListener("click", () => {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'en-US';
      recognition.start();
      recognition.onresult = (e) => {
        input.value = e.results[0][0].transcript;
      };
    });

    input.addEventListener("keypress", function (e) {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        form.dispatchEvent(new Event("submit"));
      }
    });

    function clearChat() {
      chatbox.innerHTML = "";
      prompt.style.display = 'block';
      localStorage.removeItem("chatHistory");
      document.querySelector("main").classList.remove("chat-started");
      
      // Hide scroll-down icon
      const scrollIcon = document.getElementById("scrollDown");
      if (scrollIcon) scrollIcon.style.display = "none";
    }

    function exportDocx() {
      alert("Exporting to DOCX â€“ feature under development");
    }

    function exportPdf() {
      alert("Exporting to PDF â€“ feature under development");
    }

    function scrollToBottom() {
      chatbox.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.getElementById("shareIcon").addEventListener("click", () => {
      navigator.clipboard.writeText(window.location.href);
      alert("Page link copied to clipboard.");
    });

    // Show the icon when content is scrollable
function maybeShowScrollIcon() {
  const chatbox = document.getElementById("chatbox");
  const scrollIcon = document.getElementById("scrollDown");

  if (chatbox.scrollHeight > chatbox.clientHeight) {
    scrollIcon.style.display = "block";
  } else {
    scrollIcon.style.display = "none";
  }
}

window.addEventListener("load", maybeShowScrollIcon);
window.addEventListener("resize", maybeShowScrollIcon);


     function toggleDropdown(el) {
    const dropdown = el.querySelector('.dropdown-content');
    dropdown.classList.toggle('show');
  }

  // Close all dropdowns when clicking outside
  document.addEventListener("click", function (event) {
    if (!event.target.closest('.dropdown-menu')) {
      document.querySelectorAll('.dropdown-content').forEach(el => el.classList.remove('show'));
    }
  });
    
async function fetchJobs(query) {
  try {
    const res = await fetch("/jobs", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        query: query,
        location: "",
        jobType: ""
      })
    });

    const data = await res.json();
    displayJobs(data);
  } catch (err) {
    console.error("Job fetch error:", err);
  }
}

function displayJobs(data) {
  const aiAnswerBlock = document.querySelector(".chatbox .chat-entry .ai-answer:last-child");
  if (!aiAnswerBlock) return;

  const jobsContainer = document.createElement("div");
  jobsContainer.className = "job-listings";

  const allJobs = [...(data.remotive || []), ...(data.adzuna || [])];

  if (allJobs.length === 0) {
    jobsContainer.innerHTML = "<p>No jobs found for this query.</p>";
  } else {
    allJobs.forEach(job => {
      const jobCard = document.createElement("div");
      jobCard.className = "job-card";
      jobCard.innerHTML = `
        <h3>${job.title}</h3>
        <p><strong>${job.company}</strong> â€“ ${job.location}</p>
        <a href="${job.url}" target="_blank">View Job</a>
      `;
      jobsContainer.appendChild(jobCard);
    });
  }

  aiAnswerBlock.appendChild(jobsContainer);
}
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
    }
    function showChatHistory() {
      alert("Recent chat history will go here.");
    }
    function sharePage() {
      navigator.clipboard.writeText(window.location.href);
      alert("Link copied!");
    }
</script>
<img id="scrollDown" class="scroll-down-icon" src="/static/icons/scrolldown.svg" alt="Scroll Down" onclick="scrollToBottom()">

</body>
</html>
