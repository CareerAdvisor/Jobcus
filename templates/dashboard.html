{% extends "base.html" %}

{% block title %}My Dashboard – Jobcus{% endblock %}

{% block content %}
<section class="dashboard-container">
  <h1 id="dashboardGreeting" class="dashboard-title"></h1>
  <p class="dashboard-subtitle">
    Track your career growth and insights powered by Jobcus AI.
  </p>

  <div class="dashboard-cards">
    <!-- Resume Score -->
    <div class="dashboard-card">
      <h3>📄 Resume Score</h3>
      <div class="progress-circle" data-score="0">
        <svg viewBox="0 0 36 36">
          <path class="bg" d="M18 2.0845
            a 15.9155 15.9155 0 0 1 0 31.831
            a 15.9155 15.9155 0 0 1 0 -31.831"/>
          <path class="progress" stroke-dasharray="0,100" d="M18 2.0845
            a 15.9155 15.9155 0 0 1 0 31.831
            a 15.9155 15.9155 0 0 1 0 -31.831"/>
          <text x="18" y="20.35" class="percentage">0%</text>
        </svg>
        <p class="metric-note">Last analyzed: just now</p>
      </div>
    </div>
  </div>

  <!-- If no analysis saved, show big CTA -->
  <div id="no-analysis-cta" style="text-align:center; margin:2rem 0;">
    <p>You haven’t analyzed a resume yet.</p>
    <a href="/resume-builder" class="cta-primary">Analyze your resume now</a>
  </div>

  <!-- 🍀 Styled Detailed Analysis + Optimize CTA -->
  <section
    id="resume-analysis"
    class="analysis-section"
    style="display:none; margin-top:2rem;"
  >
    <h2>🔍 Steps to Improve Your Resume</h2>

    <div class="analysis-block issues">
      <h3>⚠️ Issues Found</h3>
      <ul id="top-issues">
        <!-- populated by dashboard.js -->
      </ul>
    </div>

    <div class="analysis-block strengths" style="margin-top:1rem;">
      <h3>✅ What You Did Well</h3>
      <ul id="good-points">
        <!-- populated by dashboard.js -->
      </ul>
    </div>

    <div class="analysis-block suggestions" style="margin-top:1rem;">
      <h3>💡 Suggestions</h3>
      <ul id="suggestions-list">
        <!-- populated by dashboard.js -->
      </ul>
    </div>

    <!-- ↓↓↓ Optimize UI ↓↓↓ -->
    <div class="analysis-cta">
      <p>Want us to apply these fixes automatically? ✨</p>
      <button id="optimize-btn" class="btn-optimize">Optimize My Resume</button>
    </div>

    <div id="optimize-section" style="margin-top:2rem; display:flex; flex-direction:column; align-items:center;">
      <div id="optimized-loading" style="display:none; color:#555;">
        🤖 Optimizing your resume, please wait…
      </div>
      <pre id="optimized-output" style="display:none; white-space:pre-wrap; background:#f9f9f9; padding:1rem; border-radius:6px;"></pre>

      {% if current_user.is_authenticated %}
        <div id="optimized-downloads" style="display:none; margin-top:1rem;">
          <button onclick="downloadOptimizedResume('pdf')">⬇️ Download PDF</button>
          <button onclick="downloadOptimizedResume('txt')">⬇️ Download TXT</button>
        </div>
      {% else %}
        <div style="margin-top:1rem; text-align:center;">
          <p>
            To download your optimized resume, 
            <strong><a href="/account" style="color: #104879; text-decoration: none;">Sign up or log in</a></strong>.
          </p>
        </div>
      {% endif %}
    </div>
  </section>

  <div style="text-align:center; margin:3rem 0;">
    <p>
      Want to <strong>save</strong> your results and track progress over time?
      <strong><a href="/account" style="color: #104879; text-decoration: none;">Sign up or log in</a></strong>
    </p>
  </div>
</section>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
{% endblock %}
