<!-- skill-gap.html -->
{% extends "base.html" %}

{% block title %}Skill Gap Analysis ‚Äì Jobcus{% endblock %}

{% block content %}
<div class="skill-gap-container">
  <section class="skill-gap-hero">
    <h1>üß© Skill Gap Analysis</h1>
    <p>Find out what skills you're missing for your dream job‚Äîand how to close the gap.</p>
  </section>

  <section class="skill-gap-form">
    <form id="skill-gap-form">
      <label for="goal">Career Goal</label>
      <input type="text" id="goal" name="goal" placeholder="e.g., Data Scientist" required>

      <label for="skills">Your Current Skills</label>
      <input type="text" id="skills" name="skills" placeholder="e.g., Excel, SQL" required>

      <button type="submit">Analyze My Gap</button>
    </form>
  </section>

  <section class="skill-gap-result">
    <h2>üìã Your Results</h2>
    <div id="skill-gap-output">Enter your goal and skills to get AI-powered insights.</div>
  </section>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("skill-gap-form").addEventListener("submit", async function (e) {
  e.preventDefault();
  const goal = document.getElementById("goal").value;
  const skills = document.getElementById("skills").value;
  const output = document.getElementById("skill-gap-output");

  output.innerHTML = "<em>‚è≥ Analyzing skill gaps...</em>";

  try {
    const response = await fetch("/api/skill-gap", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ goal, skills })
    });

    const data = await response.json();

    if (data.result) {
      output.innerHTML = `<pre>${data.result}</pre>`;
    } else {
      output.innerHTML = "‚ö†Ô∏è Could not retrieve analysis. Try again.";
    }
  } catch (error) {
    console.error("Skill Gap Fetch Error:", error);
    output.innerHTML = "‚ö†Ô∏è An error occurred while processing your request.";
  }
});
</script>
{% endblock %}
