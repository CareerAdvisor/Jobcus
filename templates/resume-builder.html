{% extends "base.html" %}
{% block title %}Resume Builder – Jobcus{% endblock %}

{% block content %}

<!-- Top tabs (mobile-first) -->
<nav class="rb-tabs">
  <button class="active" data-target="#write">Write</button>
  <button data-target="#design">Design</button>
  <button data-target="#improve">Improve</button>
</nav>

<main id="resume-builder" class="rb-wrap">
  <form id="resumeForm" class="rb-form">

    <!-- WRITE -->
    <section id="write" class="rb-step">

      <!-- Personal details -->
      <article class="rb-card">
        <header>
          <h2>Personal details</h2>
          <p>Give recruiters a quick overview.</p>
        </header>

        <div class="rb-grid">
          <label>First name
            <input type="text" name="firstName" required>
          </label>
          <label>Last name
            <input type="text" name="lastName">
          </label>
          <label class="full">Job title
            <input type="text" name="title" placeholder="e.g., IT Support Specialist">
          </label>
        </div>

        <details class="rb-disclosure">
          <summary>Show additional details</summary>
          <div class="rb-grid">
            <label>Nationality <input type="text" name="nationality"></label>
            <label>Driver’s licence <input type="text" name="drivers"></label>
            <label>Birth date <input type="date" name="dob"></label>
          </div>
        </details>
      </article>

      <!-- Contact information -->
      <article class="rb-card">
        <header>
          <h2>Contact information</h2>
          <p>Make it easy to reach you.</p>
        </header>

        <div class="rb-grid">
          <label class="full">Email <input type="email" name="email"></label>
          <label class="full">Phone <input type="tel" name="phone"></label>
          <label>Country <input type="text" name="country"></label>
          <label>City <input type="text" name="city"></label>
          <label class="full">Address <input type="text" name="address"></label>
          <label>Postcode <input type="text" name="postcode"></label>
          <label class="full">LinkedIn / Portfolio <input type="url" name="portfolio"></label>
        </div>
      </article>

      <!-- Professional summary -->
      <article class="rb-card">
        <header>
          <h2>Professional summary</h2>
          <p>1–3 crisp sentences with measurable wins.</p>
        </header>
        <textarea name="summary" rows="5" placeholder="e.g., IT Support Specialist with 5+ years..."></textarea>
      </article>

      <!-- Employment history -->
      <article class="rb-card" data-repeater="experience">
        <header>
          <h2>Employment history</h2>
          <p>Use action verbs and numbers.</p>
        </header>

        <template id="tpl-experience">
          <div class="rb-item">
            <div class="rb-grid">
              <label class="full">Job title <input type="text" name="role"></label>
              <label class="full">Company name <input type="text" name="company"></label>
              <label>Start date <input type="text" name="start" placeholder="Jan 2021"></label>
              <label>End date <input type="text" name="end" placeholder="Present"></label>
              <label class="full">Location <input type="text" name="location"></label>
            </div>
            <label class="full">Highlights (one per line)
              <textarea name="bullets" rows="4" placeholder="• Reduced ticket backlog by 32%..."></textarea>
            </label>
            <div class="rb-actions"><button type="button" class="rb-remove">Remove</button></div>
          </div>
        </template>

        <div class="rb-list" id="exp-list"></div>
        <button type="button" class="rb-add" data-add="experience">+ Add another experience</button>
      </article>

      <!-- Skills -->
      <article class="rb-card">
        <header>
          <h2>Skills</h2>
          <p>Most relevant skills first.</p>
        </header>
        <div class="rb-chip-input">
          <input type="text" id="skillInput" placeholder="Type a skill and press Enter">
          <div id="skillChips" class="rb-chips"></div>
          <input type="hidden" name="skills"> <!-- comma-separated -->
        </div>
      </article>

      <!-- Education -->
      <article class="rb-card" data-repeater="education">
        <header>
          <h2>Education</h2>
        </header>

        <template id="tpl-education">
          <div class="rb-item">
            <div class="rb-grid">
              <label class="full">Institution <input type="text" name="school"></label>
              <label class="full">Degree <input type="text" name="degree"></label>
              <label>Start date <input type="text" name="graduatedStart" placeholder="Sep 2017"></label>
              <label>End date <input type="text" name="graduated" placeholder="Jun 2021"></label>
              <label class="full">Location <input type="text" name="location"></label>
            </div>
            <div class="rb-actions"><button type="button" class="rb-remove">Remove</button></div>
          </div>
        </template>

        <div class="rb-list" id="edu-list"></div>
        <button type="button" class="rb-add" data-add="education">+ Add education</button>
      </article>
    </section>

    <!-- DESIGN -->
    <section id="design" class="rb-step" hidden>
      <article class="rb-card">
        <header><h2>Design</h2><p>Pick a template.</p></header>
        <label>Theme
          <select id="themeSelect" name="theme">
            <option value="modern" selected>Modern</option>
            <option value="minimal">Minimal</option>
          </select>
        </label>
        <div class="rb-row">
          <button type="button" id="previewTemplate" class="cta-secondary">Preview</button>
          <button type="button" id="downloadTemplatePdf" class="cta-primary">Download PDF</button>
        </div>

        <div id="resumePreviewWrap" style="display:none; margin-top:1rem;">
          <h3>Preview</h3>
          <iframe id="resumePreview" class="resume-preview" style="width:100%; height:100vh; border:0; background:#fff;"></iframe>
        </div>
      </article>
    </section>

    <!-- IMPROVE (optional stub) -->
    <section id="improve" class="rb-step" hidden>
      <article class="rb-card">
        <header><h2>Improve</h2><p>Use AI to tighten bullets, tone and length. (Coming soon)</p></header>
      </article>
    </section>

    <!-- Sticky footer controls -->
    <footer class="rb-footer">
      <button type="button" id="rb-back" class="ghost">Back</button>
      <button type="submit" id="rb-generate" class="cta-primary">Generate Resume</button>
      <button type="button" id="rb-next" class="cta-secondary">Next</button>
    </footer>
  </form>
</main>

{% endblock %}

{% block scripts %}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="{{ url_for('static', filename='js/resume-builder.js') }}"></script>
{% endblock %}
