<!-- interview-coach.html -->
{% extends "base.html" %}

{% block title %}Interview Coach ‚Äì Jobcus{% endblock %}

{% block content %}
<div class="interview-container">
  <section class="interview-hero">
    <h1>üé§ AI Interview Coach</h1>
    <p>Get personalized mock questions and fallback tips based on your target role, experience level, and whether you‚Äôre switching careers.</p>
  </section>

  <section class="interview-form-section">
    <form id="interviewForm">
      <label for="role">Target Role</label>
      <input type="text" id="role" name="role" placeholder="e.g., Frontend Developer" required />

      <label for="experience">Experience Level</label>
      <select id="experience" name="experience" required>
        <option value="">Select experience level</option>
        <option value="Entry-level">Entry-level</option>
        <option value="Mid-level">Mid-level</option>
        <option value="Senior">Senior</option>
      </select>

      <label class="switch-career-checkbox">
        <input type="checkbox" id="careerSwitch" />
        I'm switching careers to this new role
      </label>

      <button type="submit">Get Interview Tips</button>
    </form>
  </section>

  <section class="interview-result">
    <div id="interviewOutput" class="interview-response">
      Enter your role and experience level to get started.
    </div>
  </section>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("interviewForm").addEventListener("submit", async function (e) {
  e.preventDefault();

  const role = document.getElementById("role").value.trim();
  const experience = document.getElementById("experience").value;
  const careerSwitch = document.getElementById("careerSwitch").checked;
  const output = document.getElementById("interviewOutput");

  if (!role || !experience) {
    output.innerHTML = "‚ö†Ô∏è Please provide both role and experience level.";
    return;
  }

  output.innerHTML = "<em>‚è≥ Generating interview questions...</em>";

  try {
    const response = await fetch("/api/interview", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ role, experience, switch: careerSwitch })
    });

    const data = await response.json();

    if (data.result) {
      output.innerHTML = `<div class='ai-response'><pre>${data.result}</pre></div>`;
    } else {
      output.innerHTML = "‚ö†Ô∏è No result returned. Try again.";
    }
  } catch (err) {
    console.error("Interview API Error:", err);
    output.innerHTML = "‚ùå Something went wrong. Please try again later.";
  }
});
</script>
{% endblock %}
