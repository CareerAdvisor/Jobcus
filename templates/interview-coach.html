<!-- templates/interview-coach.html -->
{% extends "base.html" %}

{% block title %}Interview Coach â€“ Jobcus{% endblock %}

{% set is_paid  = current_user.is_authenticated and (current_user.plan|lower in ['standard','premium']) %}
{% set wm_text  = '' if is_paid else 'JOBCUS.COM' %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/interview-coach.css') }}">

{# JSON-LD: SoftwareApplication for Interview Coach #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Jobcus Interview Coach",
  "applicationCategory": "BusinessApplication",
  "operatingSystem": "Web",
  "url": "https://www.jobcus.com/interview-coach",
  "image": "https://www.jobcus.com/static/images/og/jobcus-og.jpg",
  "description": "Practice realistic interview questions and get instant AI feedback on your answers to improve confidence and performance.",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "url": "https://www.jobcus.com/pricing"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jobcus",
    "url": "https://www.jobcus.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.jobcus.com/static/icons/apple-touch-icon.png"
    }
  }
}
</script>

{# JSON-LD: Breadcrumbs for richer SERP trails #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://www.jobcus.com/" },
    { "@type": "ListItem", "position": 2, "name": "Interview Coach", "item": "https://www.jobcus.com/interview-coach" }
  ]
}
</script>
{% endblock %}

{% block content %}
<main id="interviewCoach" class="interview-container">

  <!-- Hero -->
  <section class="interview-hero-full" aria-label="Interview Coach">
    <img
      src="{{ url_for('static', filename='images/interview-coach.png') }}"
      alt="Jobcus Interview Coach illustration"
      loading="eager"
      decoding="async"
    >
  </section>

  <!-- Optional live preview frame (hidden until used) -->
  <section id="coachPreviewSection" style="margin:18px 0; display:none;">
    <div id="coachWrap" class="preview-wrap"
         {% if wm_text %} data-watermark="{{ wm_text }}"{% endif %}>
      <iframe id="coachPreview"
              style="width:100%;height:70vh;border:0;background:#fff;"
              loading="lazy"></iframe>
    </div>
  </section>

  <!-- Lead copy + role setup form -->
  <section class="interview-form-section">
    <p style="margin-bottom:16px;font-weight:500;color:#104879;">
      Ace your interviews using Jobcusâ€™ smart AI career coach, designed to simulate real scenarios.
    </p>

    <form id="interview-role-form" autocomplete="on" novalidate>
      <label for="previousRole">Your Previous Role</label>
      <input
        type="text"
        id="previousRole"
        name="previousRole"
        placeholder="e.g., Customer Support Rep"
        required
      />

      <label for="targetRole">Target Role</label>
      <input
        type="text"
        id="targetRole"
        name="targetRole"
        placeholder="e.g., UX Designer"
        required
      />

      <label for="experience">Experience Level</label>
      <select id="experience" name="experience" required>
        <option value="">Select experience level</option>
        <option value="Entry-level">Entry-level</option>
        <option value="Mid-level">Mid-level</option>
        <option value="Senior">Senior</option>
      </select>

      <button type="submit">ðŸŽ¤ Start Interview</button>
    </form>
  </section>

  <!-- Live interview session (hidden until started) -->
  <section class="interview-session" style="display:none;">
    <div
      id="ai-question"
      class="ai-question-box"
      role="status"
      aria-live="polite"
    >
      Click Next to begin your interview.
    </div>

    <form id="user-response-form" style="display:none;">
      <label class="sr-only" for="userAnswer">Your answer</label>
      <textarea
        id="userAnswer"
        placeholder="Type your response..."
        required
        rows="5"
      ></textarea>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px;">
        <button id="next-question-btn" type="button">ðŸŽ¤ Next Question</button>
        <button type="submit">Submit Answer</button>
        <button id="toggle-history-btn" type="button">ðŸ“œ Show History</button>
      </div>
    </form>

    <!-- Collapsible Q&A history -->
    <section class="interview-history">
      <div
        id="history-container"
        class="history-box"
        style="display:none;"
        aria-live="polite"
      >
        <!-- Responsive history panel wrapper (prevents horizontal overflow) -->
        <div id="historyPanel" class="history-panel"
             {% if wm_text %} data-watermark="{{ wm_text }}" data-watermark-tile="1"{% endif %}>
          <div id="historyContent" class="ai-response"><!-- feedback markdown injected here --></div>
        </div>
      </div>
    </section>

    <!-- AI tip suggestions (when available) -->
    <div id="suggestions-box" class="fallback-box" style="display:none;"
         {% if wm_text %} data-watermark="{{ wm_text }}"{% endif %}
         aria-live="polite"></div>

    <!-- Per-answer feedback -->
    <div id="feedback-box" class="result-box" style="display:none;"
         {% if wm_text %} data-watermark="{{ wm_text }}"{% endif %}
         aria-live="polite"></div>
  </section>

</main>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/interview-coach.js') }}" defer></script>
{% endblock %}
