{% extends "base.html" %}

{% block title %}Resume Analyzer – Jobcus{% endblock %}

{% set wm = (current_user.email ~ " · Jobcus") if current_user.is_authenticated else "Guest · Jobcus" %}
{% set is_paid = (current_user.is_authenticated and (current_user.plan|lower in ['standard','premium'])) %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

  <style>
    /* ===== Scope everything to this page ===== */
    .res-page { background:#f6f8fb; }

    /* Same desktop width as index/resume: min(1150px, 92%) */
    .res-page .container{
      width: min(1150px, 92%);
      margin: 0 auto;
      padding: 0 0 24px; /* outer vertical space only; horizontal via width calc */
    }

    /* A “panel” width for readable forms/cards (like on dashboard) */
    .res-page .narrow{
      max-width: 900px;
      margin: 0 auto;
    }

    /* Fluid hero (scoped) */
    .res-page .hero-wrap{ background:#104879; padding:20px 0; }
    .res-page .hero{
      display:flex; flex-direction:column; align-items:center; text-align:center;
      padding: clamp(16px, 4vw, 48px) clamp(12px, 4vw, 24px);
      background:#104879; border-radius:14px;
    }
    .res-page .hero-kicker{
      color:#ffc957; font-weight:600; letter-spacing:.08em;
      font-size: clamp(12px, 1.2vw, 18px);
      margin: 0 0 clamp(6px, .8vw, 10px);
    }
    .res-page .hero-title{
      color:#fff; font-weight:700; line-height:1.15; margin: 0;
      font-size: clamp(24px, 4.5vw + .25rem, 50px);
    }
    .res-page .hero-title .accent { color:#ffc957; }
    .res-page .hero-subtitle{
      color:#fff; opacity:.95;
      margin: clamp(10px, 1.5vw, 14px) 0 clamp(18px, 2vw, 24px);
      max-width: 60ch;
      font-size: clamp(16px, 1.2vw + .25rem, 22px);
      line-height: 1.5;
    }
    @media (min-width: 768px){
      .res-page .hero-subtitle { max-width: 46rem; }
    }

    /* Section wrapper under hero */
    .res-page .section{
      padding: 30px 0;
      background:#f9fafb;
    }

    /* Optional: avoid accidental horizontal scrolling on small screens */
    html, body { overflow-x: hidden; }
  </style>
{% endblock %}


{% block content %}
<main class="res-page">

  <!-- Hero -->
  <div class="interview-container" style="padding:20px 16px;width:100%;background:#104879;">
    <section class="interview-hero-with-image hero">
      <h5 class="hero-kicker">AI RESUME ANALYZER</h5>
      <h1 class="hero-title">
        Improve your <span class="accent">resume</span> with instant feedback
      </h1>
      <p class="hero-subtitle">
        Get a score, keyword insights, and actionable suggestions, all optimized for ATS.
      </p>
    </section>
  </div>

  <!-- Analyzer (IDs match dashboard for shared JS) -->
  <section id="resume-analyzer" style="padding:30px 16px; background:#f9fafb;">
    <div style="max-width:100%;margin:0 auto;">
      <h2 style="color:#104879;margin:0 0 10px;">AI Resume Analyzer</h2>
      <p style="color:#555;margin:0 0 16px;">
        Upload a PDF or DOCX and optionally paste a job description or target role. Results will appear on your dashboard.
      </p>

      <!-- Upload card -->
      <article class="card upload-card" aria-labelledby="uploadCardTitle">
        <h3 id="uploadCardTitle" class="upload-title">
          Upload a PDF/DOCX. Optionally add a job description to check keyword match.
        </h3>

        <div id="dropzone" class="dropzone" role="button" tabindex="0"
             aria-label="Browse files, or drag and drop your resume here"
             onclick="document.getElementById('dashResumeFile').click()">
          <div class="dropzone__cloud" aria-hidden="true"></div>
          <div class="dropzone__title">Browse Files</div>
          <div class="dropzone__hint">Drag and drop files here</div>
          <input id="dashResumeFile" type="file"
                 accept="application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                 hidden>
        </div>

        <div id="fileName" class="file-name" aria-live="polite"></div>

        <label class="field">
          <span class="field__label sr-only">Job description (optional)</span>
          <textarea id="dashJobDesc" class="textarea"
                    placeholder="Optional: paste job description to check keywords…"
                    rows="6"></textarea>
        </label>

        <label class="field">
          <span class="field__label center">Or pick a target role to assess relevance</span>
          <input id="dashRoleSelect" class="select" list="roleList"
                 placeholder="Start typing a role (e.g., Business Analyst, Azure Architect, Animator)…" />
          <datalist id="roleList"></datalist>
        </label>

        <div class="actions">
          <button id="dashAnalyzeBtn" class="btn btn-primary" disabled>Analyze resume</button>
          <span id="dashAnalyzing" class="loading" style="display:none;" aria-live="polite">Analyzing…</span>
        </div>

        <p class="help">
          Your latest result is saved locally. Standard &amp; Premium plans sync across devices.
        </p>

        <!-- Inline notice rail; JS can toggle text + visibility -->
        <div id="analyzerNotice" class="notice" hidden role="alert" aria-live="polite"></div>
      </article>

      <!-- Centered Cover Letter CTA -->
      <div style="text-align:center; margin-top:24px;">
        <a id="openCoverLetter" href="/cover-letter" class="primary-btn"
           style="background:#ffc957;color:#104879;padding:12px 16px;border-radius:6px;
                  text-decoration:none;font-weight:600;font-size:16px;display:inline-block;">
          ➜ Create Cover Letter
          <small style="display:block;font-weight:400;font-size:14px;color:#104879;">
            Opens cover letter page
          </small>
        </a>
      </div>
    </div>
  </section>

</main>
{% endblock %}

{% block scripts %}
  <script defer src="{{ url_for('static', filename='js/base.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/resume-analyzer.js') }}"></script>
{% endblock %}
