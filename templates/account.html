{# templates/account.html #}
{% extends "base.html" %}

{% block title %}Jobcus – Sign In / Sign Up{% endblock %}
{% block body_class %}account-page{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/account.css') }}">
{% endblock %}

{% block content %}
<div id="accountShell"
     data-free-used="{{ '1' if (current_user.is_authenticated and (current_user.free_plan_used | default(false))) else '0' }}">

  <section class="auth-wrapper">
    <div class="auth-card auth-card--blue">

      {# — Heading & subtitle; initial state based on `mode` from Flask — #}
      <h2 class="auth-title">
        {% if mode == 'login' %}
          Sign In to<br>Jobcus
        {% else %}
          Sign Up to<br>Jobcus
        {% endif %}
      </h2>
      <p class="auth-subtitle">
        {% if mode == 'login' %}
          Good to see you again! Welcome back.
        {% else %}
          Create a free account to get started.
        {% endif %}
      </p>

      {# — Flash messages container — #}
      <div id="flashMessages" class="flash-message">
        {% for msg in get_flashed_messages() %}
          <div class="flash-item">{{ msg }}</div>
        {% endfor %}
      </div>

      <form id="accountForm" class="auth-form" autocomplete="on">
        <input type="hidden" name="mode" id="mode" value="{{ mode }}" />

        {# — Full Name only shown by JS when mode==='signup' — #}
        <div class="form-group" id="nameGroup">
          <label for="name">Full Name</label>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Your full name"
          />
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="you@example.com"
            required
          />
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Enter your password"
            required
          />
        </div>

        <button type="submit" class="btn-primary" id="submitButton">
          {% if mode=='login' %}Sign In{% else %}Sign Up{% endif %}
        </button>

        <p class="toggle-text">
          <span id="togglePrompt">
            {% if mode=='login' %}
              Don’t have an account?
            {% else %}
              Already have an account?
            {% endif %}
          </span>
          <a href="#" id="toggleMode" class="toggle-link">
            {% if mode=='login' %}Sign Up{% else %}Sign In{% endif %}
          </a>
        </p>

        <p class="text-sm">
          <a href="{{ url_for('forgot_password') }}">Forgot your password?</a>
        </p>

        <div class="or-divider"><span>OR</span></div>

        <div class="social-buttons">
          <a class="social-btn fb" href="/oauth/facebook"  aria-label="Sign in with Facebook">
            <img src="{{ url_for('static', filename='icons/facebook.svg') }}" alt="">
          </a>
          <a class="social-btn google" href="/oauth/google" aria-label="Sign in with Google">
            <img src="{{ url_for('static', filename='icons/google.png') }}" alt="">
          </a>
          <a class="social-btn linkedin" href="/oauth/linkedin" aria-label="Sign in with LinkedIn">
            <img src="{{ url_for('static', filename='icons/linkedin.svg') }}" alt="">
          </a>
          <a class="social-btn apple" href="/oauth/apple" aria-label="Sign in with Apple">
            <img src="{{ url_for('static', filename='icons/apple.svg') }}" alt="">
          </a>
        </div>
      </form>
    </div>
  </section>

  {# — Simple Plan chooser block (works whether you're on login or account page) — #}
  <section class="plan-chooser" style="max-width:720px;margin:24px auto;">
    <h3 style="margin-bottom:8px;">Choose your plan</h3>
    <p class="text-sm" style="margin-bottom:12px;">Free can be activated once. Paid plans can be resubscribed anytime.</p>
    <div class="plan-buttons" style="display:flex;gap:12px;flex-wrap:wrap;">
      <button id="chooseFreeBtn" class="btn-secondary" onclick="pickPlan('free')">Choose Free</button>
      <button class="btn-secondary" onclick="pickPlan('weekly')">Weekly</button>
      <button class="btn-secondary" onclick="pickPlan('standard')">Standard</button>
      <button class="btn-secondary" onclick="pickPlan('premium')">Premium</button>
    </div>
  </section>

</div>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/account.js') }}" defer></script>
{% endblock %}
