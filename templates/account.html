{# templates/account.html #}
{% extends "base.html" %}

{% block title %}Jobcus – Sign In / Sign Up{% endblock %}
{% block body_class %}account-page{% endblock %}

{# Page-specific CSS #}
{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/account.css') }}">
{% endblock %}

{% block content %}
<section class="auth-wrapper">
  <div class="auth-card auth-card--blue">

    {# Headline switches by mode #}
    <h2 class="auth-title">
      {% if mode == 'login' %}
        Sign In to<br>Jobcus
      {% else %}
        Sign Up to<br>Jobcus
      {% endif %}
    </h2>
    <p class="auth-subtitle">
      {% if mode == 'login' %}
        Good to see you again! Welcome back.
      {% else %}
        Create a free account to get started.
      {% endif %}
    </p>

    {# Flash messages container (filled by JS or Flask) #}
    <div id="flashMessages" class="flash-message">
      {% for msg in get_flashed_messages() %}
        <div class="flash-item">{{ msg }}</div>
      {% endfor %}
    </div>

    <form id="accountForm" class="auth-form" autocomplete="on">
      <input type="hidden" name="mode" id="mode" value="{{ mode }}" />

      {# Full Name — JS hides this on login #}
      <div class="form-group" id="nameGroup">
        <label for="name">Full Name</label>
        <input
          type="text"
          id="name"
          name="name"
          placeholder="Your full name"
          autocomplete="name"
        />
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          name="email"
          placeholder="you@example.com"
          required
          autocomplete="email"
          autocapitalize="none"
          spellcheck="false"
          inputmode="email"
        />
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input
          type="password"
          id="password"
          name="password"
          placeholder="Enter your password"
          required
          autocomplete="{{ 'current-password' if mode=='login' else 'new-password' }}"
        />
      </div>

      {# ── Cloudflare Turnstile (visible checkbox) ──
         - Keep this inside the form
         - account.js listens for onTurnstileToken / error / timeout
      #}
      <div class="form-group">
        <div
          class="cf-turnstile"
          id="cfWidget"
          data-sitekey="{{ turnstile_site_key }}"
          data-callback="onTurnstileToken"
          data-error-callback="onTurnstileError"
          data-timeout-callback="onTurnstileTimeout"
          data-appearance="always"
          data-size="flexible"
          data-theme="light">
        </div>
        <noscript>
          <p style="color:#b42318;margin-top:8px;">
            JavaScript is required to complete the CAPTCHA.
          </p>
        </noscript>
      </div>

      <button type="submit" class="btn-primary" id="submitButton" disabled>
        {% if mode=='login' %}Sign In{% else %}Sign Up{% endif %}
      </button>

      <p class="toggle-text">
        <span id="togglePrompt">
          {% if mode=='login' %}
            Don’t have an account?
          {% else %}
            Already have an account?
          {% endif %}
        </span>
        <a href="#" id="toggleMode" class="toggle-link">
          {% if mode=='login' %}Sign Up{% else %}Sign In{% endif %}
        </a>
      </p>

      <div class="or-divider"><span>OR</span></div>

      <div class="social-buttons">
        <button type="button" class="social-btn fb" aria-label="Continue with Facebook">
          <img src="{{ url_for('static', filename='icons/facebook.svg') }}" alt="Facebook">
        </button>
        <button type="button" class="social-btn google" aria-label="Continue with Google">
          <img src="{{ url_for('static', filename='icons/google.png') }}" alt="Google">
        </button>
        <button type="button" class="social-btn linkedin" aria-label="Continue with LinkedIn">
          <img src="{{ url_for('static', filename='icons/linkedin.svg') }}" alt="LinkedIn">
        </button>
        <button type="button" class="social-btn apple" aria-label="Continue with Apple">
          <img src="{{ url_for('static', filename='icons/apple.svg') }}" alt="Apple">
        </button>
      </div>
    </form>
  </div>
</section>
{% endblock %}

{% block scripts %}
  {# Turnstile script must be present on this page #}
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  <script src="{{ url_for('static', filename='js/account.js') }}"></script>
{% endblock %}
