{# templates/base.html #}
<!DOCTYPE html>
<html lang="en-GB">
<head>
  <!-- ====== Core Document & Viewport ====== -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="canonical" href="{{ request.url if request else '' }}">

  <!-- ====== SEO (chat-first defaults; pages can override blocks) ====== -->
  <title>{% block title %}Jobcus â€“ AI Career Chat & Advisor{% endblock %}</title>
  <meta name="description" content="{% block meta_description %}Jobcus is an AI-powered career assistant designed to help job seekers build optimised resumes, analyse their skill gaps, prepare for interviews, and gain job market insights - all in one platform.{% endblock %}">
  <meta name="keywords" content="AI career chat, career advisor, resume analyzer, resume builder, cover letter, interview coach, skill gap, job insights, ATS, Jobcus, AI">
  <meta name="author" content="Jobcus">
  <meta name="robots" content="index,follow,max-image-preview:large">

  <!-- ====== Social / Open Graph ====== -->
  <meta property="og:site_name" content="Jobcus">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ request.url if request else 'https://www.jobcus.com' }}">
  <meta property="og:title" content="{% block og_title %}Jobcus â€“ AI Career Chat & Advisor{% endblock %}">
  <meta property="og:description" content="{% block og_description %}Jobcus is an AI-powered career assistant designed to help job seekers build optimised resumes, analyse their skill gaps, prepare for interviews, and gain job market insights - all in one platform.{% endblock %}">
  <meta property="og:image" content="{{ url_for('static', filename='images/og/jobcus-og.jpg', _external=True) if url_for else '' }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Jobcus â€“ AI Career Chat & Advisor">

  <!-- ====== Twitter Cards ====== -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@jobcus">
  <meta name="twitter:title" content="{% block tw_title %}Jobcus â€“ AI Career Chat & Advisor{% endblock %}">
  <meta name="twitter:description" content="{% block tw_description %}Chat-first career guidance: resumes, interviews, skills, and real-time job insights.{% endblock %}">
  <meta name="twitter:image" content="{{ url_for('static', filename='images/og/jobcus-og.jpg', _external=True) if url_for else '' }}">

  <!-- ====== App Icons / Favicons ====== -->
  <link rel="icon" href="{{ url_for('static', filename='icons/favicon.ico') }}" />
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='icons/favicon-32x32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='icons/favicon-16x16.png') }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">
  <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">

  <!-- ====== Fonts & Core CSS ====== -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='vendor/aos/aos.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  {% block extra_css %}{% endblock %}

  <!-- ====== Performance Hints ====== -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="dns-prefetch" href="//www.googletagmanager.com">

  <meta name="referrer" content="strict-origin-when-cross-origin">

  {% if csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token() }}">
  {% endif %}

  <!-- ====== Structured Data ====== -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Jobcus",
    "url": "https://www.jobcus.com",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://www.jobcus.com/search?q={query}",
      "query-input": "required name=query"
    }
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Jobcus",
    "url": "https://www.jobcus.com",
    "logo": "https://www.jobcus.com{{ url_for('static', filename='images/logo.png') if url_for else '/static/images/logo.png' }}",
    "sameAs": ["https://twitter.com/jobcus"]
  }
  </script>

</head>

{% set _plan = (current_user.plan | default('free', true)) %}
{% set _role = (current_user.role | default('', true)) %}
{% set _is_superadmin = current_user.is_authenticated and (_role | lower == 'superadmin') %}
{% set _wm = (current_user.email | default('Guest', true)) ~ ' Â· Jobcus' %}

<body
  class="{% block body_class %}{% endblock %}"
  data-authed="{{ '1' if current_user.is_authenticated else '0' }}"
  data-plan="{{ (current_user.plan|lower) if current_user.is_authenticated else 'guest' }}"
  data-superadmin="{{ '1' if (current_user.is_authenticated and (current_user.role|lower == 'superadmin')) else '0' }}"
>  

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WDM9T6F7"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
  <div class="page-container">

    {% if not for_pdf %}
      <header class="site-header">
        <div class="header-left">
          {% block header_icon %}{% endblock %}
        </div>

        <div class="header-logo">
          <a href="/"><img src="{{ url_for('static', filename='jobcus-logo.png') }}" alt="Jobcus" /></a>
        </div>

        <div class="header-right">
          <!-- Desktop nav (chat-first) -->
          <nav class="desktop-nav">
            <a href="/chat">{{ _("AI Career Chat") }}</a>
            <a href="/resume-analyzer">{{ _("Resume Analyzer") }}</a>
            <div class="dropdown">
              <button class="dropbtn">{{ _("Features") }} â–¾</button>
              <div class="dropdown-content">
                <a href="/resume-builder">{{ _("Resume Builder") }}</a>
                <a href="/cover-letter">{{ _("Cover Letter") }}</a>
                <a href="/interview-coach">{{ _("Interview Coach") }}</a>
                <a href="/skill-gap">{{ _("Skill Gap Analysis") }}</a>
                <a href="/job-insights">{{ _("Job Insights") }}</a>
              </div>
            </div>
            <a href="/employers">{{ _("Employers") }}</a>
          </nav>

          <div class="locale-switcher">
            <button id="localeToggle" class="locale-toggle" aria-haspopup="true" aria-expanded="false">
             
              <span class="locale-currency">{{ current_currency_meta.symbol }} {{ current_currency }}</span>
              
              <svg class="locale-chevron" viewBox="0 0 16 16" aria-hidden="true">
                <path d="M4.47 5.97a.75.75 0 0 1 1.06 0L8 8.44l2.47-2.47a.75.75 0 0 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 0 1 0-1.06Z" fill="currentColor" />
              </svg>
            </button>
            <div id="localeMenu" class="locale-menu" role="menu" aria-hidden="true">
             
              <div class="locale-section">
                <div class="locale-section-title">{{ _("Currency") }}</div>
                {% for code, meta in available_currencies.items() %}
                  <a class="locale-option {% if code == current_currency %}active{% endif %}"
                     href="{{ url_for('set_currency', currency_code=code, next=request.full_path if request else '') }}"
                     role="menuitem">
                    <span class="flag">{{ meta.flag }}</span>
                    <span class="label">{{ meta.symbol }} {{ code }}</span>
                  </a>
                {% endfor %}
              </div>
            </div>
          </div>

          {# Avatar + dropdown #}
          {% set _first = None %}
          {% set _lasti = '' %}
          {% set _name  = None %}
          {% set _email = None %}
          {% if current_user.is_authenticated %}
            {% set _email = current_user.email %}
            {% set _first = (current_user.first_name
                             or (current_user.fullname.split(' ')[0] if current_user.fullname else _email.split('@')[0])) %}
            {% set _lasti = (current_user.last_name[:1] if current_user.last_name
                             else (current_user.fullname.split(' ')[1][:1] if (current_user.fullname and current_user.fullname.split(' ')|length>1) else '')) %}
            {% set _name  = _first ~ ((' ' ~ current_user.last_name) if current_user.last_name else '') %}
          {% endif %}
          {% set _initials = ((_first[:1] ~ _lasti)|upper) if _first else '' %}

          <div class="user-menu">
            <button id="userMenuBtn" class="avatar-btn" aria-haspopup="true" aria-expanded="false">
              {% if current_user.is_authenticated %}
                <span class="avatar-circle">{{ _initials }}</span>
              {% else %}
                <img class="avatar-icon" src="{{ url_for('static', filename='icons/user.svg') }}" alt="Profile">
              {% endif %}
            </button>
            <div id="userDropdown" class="user-dropdown">
              {% if current_user.is_authenticated %}
                <div class="ud-email">{{ _email }}</div>
                <hr class="ud-sep">
                <a class="ud-item" href="{{ url_for('dashboard') }}">ðŸ‘¤ {{ _name }}</a>
                <a class="ud-item" href="{{ url_for('logout') }}">ðŸ“¦ {{ _("Log out") }}</a>
              {% else %}
                <a class="ud-item" href="{{ url_for('account') }}">ðŸ”‘ {{ _("Sign up / Log in") }}</a>
              {% endif %}
            </div>
          </div>

          <!-- Hamburger (mobile) -->
          <button class="hamburger" type="button" aria-controls="mobileMenu" aria-expanded="false">
            <div></div><div></div><div></div>
          </button>
        </div>
      
        <!-- Mobile nav -->
        <nav class="mobile-nav" id="mobileMenu">
          <a href="/chat">{{ _("AI Career Chat") }}</a>
          <a href="/resume-analyzer">{{ _("Resume Analyzer") }}</a>
          <div class="dropdown">
            <button class="dropbtn">{{ _("Features") }} â–¾</button>
            <div class="dropdown-content">
              <a href="/resume-builder">{{ _("Resume Builder") }}</a>
              <a href="/cover-letter">{{ _("Cover Letter") }}</a>
              <a href="/interview-coach">{{ _("Interview Coach") }}</a>
              <a href="/skill-gap">{{ _("Skill Gap Analysis") }}</a>
              <a href="/job-insights">{{ _("Job Insights") }}</a>
            </div>
          </div>
          <a href="/employers">{{ _("Employers") }}</a>
          <div class="mobile-locale">
            <div class="mobile-locale-title">{{ _("currency") }}</div>
            
            <div class="mobile-locale-group">
              <div class="mobile-locale-sub">{{ _("Currency") }}</div>
              {% for code, meta in available_currencies.items() %}
                <a class="mobile-locale-option {% if code == current_currency %}active{% endif %}"
                   href="{{ url_for('set_currency', currency_code=code, next=request.full_path if request else '') }}">
                  <span class="flag">{{ meta.flag }}</span>
                  <span class="label">{{ meta.symbol }} {{ code }}</span>
                </a>
              {% endfor %}
            </div>
          </div>
        </nav>
        <div class="mobile-nav-overlay" id="mobileOverlay" role="presentation"></div>
      </header>
    {% endif %}

    <main>
      {% block content %}{% endblock %}
    </main>

    {% if not for_pdf and (show_footer | default(true)) %}
    <footer class="site-footer">
  
      <!-- Social: Follow -->
      <div class="social-row">
        <div class="social-title">Follow Jobcus</div>
        <nav class="social-icons" aria-label="Jobcus social profiles">
          <!-- Update hrefs to your live handles as you wish -->
          <a class="social-btn x" href="https://twitter.com/jobcusai" target="_blank" rel="noopener" aria-label="X (Twitter)">
            <!-- X icon -->
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18.9 2H22l-9.6 11.1L21.6 22H15L9.8 15.9 4 22H.9l10.4-12L2.7 2H9l4.7 5.8L18.9 2z"/></svg>
          </a>
          <a class="social-btn linkedin" href="https://www.linkedin.com/company/jobcusai" target="_blank" rel="noopener" aria-label="LinkedIn">
            <!-- LinkedIn -->
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8.98h5V24H0V8.98zM8 8.98h4.79v2.05h.07c.67-1.27 2.31-2.6 4.76-2.6 5.09 0 6.03 3.35 6.03 7.7V24h-5v-6.76c0-1.61-.03-3.68-2.24-3.68-2.25 0-2.59 1.75-2.59 3.56V24H8V8.98z"/></svg>
          </a>
          <a class="social-btn ig" href="https://www.instagram.com/jobcusai" target="_blank" rel="noopener" aria-label="Instagram">
            <!-- Instagram -->
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5a5.5 5.5 0 1 1 0 11.001 5.5 5.5 0 0 1 0-11zM18 6.4a1.1 1.1 0 1 1 0 2.2 1.1 1.1 0 0 1 0-2.2z"/></svg>
          </a>
          <a class="social-btn fb" href="https://www.facebook.com/jobcusai" target="_blank" rel="noopener" aria-label="Facebook">
            <!-- Facebook -->
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M22 12.07C22 6.48 17.52 2 11.93 2 6.34 2 1.86 6.48 1.86 12.07c0 4.99 3.66 9.13 8.44 9.93v-7.02H7.9v-2.9h2.4V9.8c0-2.37 1.41-3.68 3.57-3.68 1.03 0 2.1.18 2.1.18v2.31h-1.18c-1.17 0-1.54.73-1.54 1.48v1.78h2.63l-.42 2.9h-2.21V22c4.78-.8 8.44-4.94 8.44-9.93z"/></svg>
          </a>
          <a class="social-btn yt" href="#" target="_blank" rel="noopener" aria-label="YouTube">
            <!-- YouTube -->
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.5 3.5 12 3.5 12 3.5s-7.5 0-9.4.6A3 3 0 0 0 .5 6.2 31 31 0 0 0 0 12a31 31 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2.1A31 31 0 0 0 24 12a31 31 0 0 0-.5-5.8zM9.6 15.5v-7l6.4 3.5-6.4 3.5z"/></svg>
          </a>
        </nav>
      </div>
  
      <!-- Your existing legal strip -->
      <div class="footer-note-static">
        &copy; 2025 Jobcus â€“ Your AI Career Advisor<br />
        <a href="/privacy-policy" class="footer-link">Privacy Policy</a>
        &nbsp;|&nbsp;
        <a href="/terms-of-service" class="footer-link">Terms of Service</a>
        &nbsp;|&nbsp;
        <a href="/faq" class="footer-link">FAQs</a>
      </div>
    </footer>
  {% endif %}

  </div>

  {% if not for_pdf and body_class != 'chat-page' %}
    <a href="/chat" class="chat-float-button" title="Chat with Jobcus">
      <img src="{{ url_for('static', filename='icons/pencilchat.svg') }}" alt="Chat Icon" />
    </a>
  {% endif %}

  {% if not for_pdf %}
    {% include "cookies.html" %}

    <script>
      window.USER_AUTHENTICATED = {{ (current_user.is_authenticated)|tojson }};
      window.AUTH_ID = {{ (current_user.id if current_user.is_authenticated else None)|tojson }};
    </script>

    <!-- Base JS (has AOS init, apiFetch, upgradePrompt, menus, cookies consent, etc.) -->
    <script src="{{ url_for('static', filename='js/base.js') }}" defer></script>
  
  <!-- DEV safety: ensure no leftover scroll/overlay locks during mobile emulation -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // Neutralize any leaked scroll-lock classes
    document.body.classList.remove('mobile-nav-open', 'has-upgrade-banner');
    document.documentElement.classList.remove('mobile-nav-open');
  
    // Make sure the mobile overlay isnâ€™t intercepting events
    const overlay = document.querySelector('.mobile-nav-overlay');
    if (overlay) overlay.classList.remove('show');
  });
  </script>

    <!-- Self-hosted AOS (CSP-safe) -->
    <script src="{{ url_for('static', filename='vendor/aos/aos.js') }}"></script>
    <script> if (window.AOS && typeof AOS.init === 'function') AOS.init(); </script>

    {% block scripts %}{% endblock %}
  {% endif %}
</body>
</html>
